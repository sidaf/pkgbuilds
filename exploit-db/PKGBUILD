pkgname='exploit-db'
pkgver=20170911
pkgrel=1
pkgdesc="The official Exploit Database repository"
url='https://github.com/offensive-security/exploit-database'
arch=('any')
license=('GPL')
depends=('bash')
makedepends=('git')
options=('!strip')
conflicts=('exploit-db-git')
source=("${pkgname}::git+https://github.com/offensive-security/exploit-database.git#tag=2017-09-11")
sha512sums=('SKIP')

prepare() {
  cd "${pkgname}"

  sed "s|gitpath=\"/opt/exploit-database\"|gitpath=\"/usr/share/${pkgname}\"|" -i searchsploit
}

package() {
  cd "${pkgname}"

  install -d "${pkgdir}/usr/bin"
  install -d "${pkgdir}/usr/share/${pkgname}/platforms"
  cp -r platforms "${pkgdir}/usr/share/${pkgname}/platforms"
  install -Dm644 "README.md" "${pkgdir}/usr/share/${pkgname}/README.md"
  install -Dm644 "files.csv" "${pkgdir}/usr/share/${pkgname}/files.csv"
  install -Dm755 "searchsploit" "${pkgdir}/usr/bin/searchsploit"
}
